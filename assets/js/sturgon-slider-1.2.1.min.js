function get_thanas(e,t){var a=$("#pd_stu").val();$.ajax({context:this,url:a+"weapons/get_thanas",type:"get",dataType:"json",cache:!0,data:{district:e},beforeSend:function(){$("#"+t).parent().append('<small id="text_loader">Loading thanas...</small>')},complete:function(){$("#text_loader").remove()}}).done(function(e){for(var a="",n=0;n<e.length;n++)a+='<option value="'+e[n].id+'">'+e[n].thana+"</option>";$("#"+t).html(a),$("#"+t).selectpicker("refresh")})}function check_duplicacy(e,t,a){var n=$("#pd_stu").val(),i=$('input[name="pd_identity"]').val();$.ajax({context:this,url:n+"/weapons/check_duplicate",type:"get",dataType:"json",cache:!0,data:{vh:e,fp:t,tp:a,pd:i}}).done(function(e){e.exist>0&&swal("Route Exist Already","Please try another","warning")})}$(document).ready(function(){var e=$("#mn_nm").val(),t=$("#cl_nm").val();"routes"!==t&&"transports"!==t&&"profile"!==t||"add"!==e&&"edit"!==e&&"all"!==e&&"show"!==e||($(".fancybox").fancybox({helpers:{overlay:{locked:!1}}}),$("#stoppage_section").sortable({placeholder:"ui-state-highlight"}),$("input[type=file]").bootstrapFileInput()),$(".dataTable").DataTable({paging:!1,info:!1,searching:!1,order:[[0,"desc"]]}),$('[data-toggle="tooltip"]').tooltip();var a=null;$(".search_place").keyup(function(e){var t=e.keyCode;if(40==t||38==t||13==t)return!1;null!==a&&(a.abort(),a=null);var n=$(this).parent().prev().prev().find("select").val(),i=$(this).parent().prev().find("select").val(),s=$.trim($(this).val());if(!s.length)return!1;var l=$("#pd_stu").val(),o=$("#pd_btu").val();a=$.ajax({context:this,url:l+"weapons/get_places",type:"get",dataType:"json",cache:!0,data:{typing:s,d:n,t:i},beforeSend:function(){$(this).parent().append('<img id="loader" src="'+o+'assets/images/loading.gif" alt="Loading"/>')},complete:function(){$("#loader").remove()}}).done(function(e){$("#loader").remove();for(var t="",a=$('input[name="f"]').val(),n=0;n<e.length;n++)e[n].Location==a&&e.splice(n,1),t+='<a href="javascript:void(0);" class="list-group-item">'+e[n].Location+"</a>";$(this).next().show().html(t)})}),$("#fare_verfication a").click(function(e){e.preventDefault();var t=$("#pd_identity").val(),a=$("#pd_stu").val(),n=$(this).data("pd_fp");$.ajax({context:this,url:a+"weapons/update_meta",type:"post",dataType:"json",cache:!0,data:{pd_identity:t,pd_sts:n},beforeSend:function(){$(this).addClass("disabled")}}).done(function(e){"exist"===e.msg&&swal("Already given","You vote once earlier in this route","warning"),"updated"===e.msg&&(swal("Thank you","You vote taken","success"),"pd_fpk"===n?$("#pd_crc").text(e.v):$("#pd_wrn").text(e.v)),$(this).removeClass("disabled")})});var n=null;$("#stoppage_section").on("keyup",".place_name",function(e){var t=e.keyCode;if(40==t||38==t||13==t)return!1;null!==n&&(n.abort(),n=null);var i=$.trim($(this).val());if(!i.length)return!1;var s=$("#pd_stu").val();a=$.ajax({context:this,url:s+"weapons/stoppage_search",type:"get",dataType:"json",cache:!0,data:{typing:i}}).done(function(e){for(var t="",a=0;a<e.length;a++)t+='<a href="javascript:void(0);" class="list-group-item">'+e[a].place_name+"</a>";$(this).next().show().html(t)})});var i=null;$("#search_place").keyup(function(e){var t=e.keyCode;if(40==t||38==t||13==t)return!1;null!==i&&(i.abort(),i=null);var n=$("#district").val(),s=$.trim($(this).val());if(!s.length)return!1;var l=$("#pd_stu").val(),o=$("#pd_stu").val();a=$.ajax({context:this,url:l+"weapons/search_places",type:"get",dataType:"json",cache:!0,data:{typing:s,d:n},beforeSend:function(){$(this).parent().append('<img id="loader" src="'+o+'assets/images/loading.gif" alt="Loading"/>')},complete:function(){$("#loader").remove()}}).done(function(e){$("#loader").remove();for(var t="",a=0;a<e.length;a++)t+='<a href="javascript:void(0);" class="list-group-item">'+e[a].Location+"</a>";$(this).next().show().html(t)})}),$("#stoppage_section").on("keydown",".place_name",function(e){var t,a=$(this).next().find("a"),n=e.keyCode,i=a.filter(".selected");if(40==n||38==n||13==n){if(40==n)a.removeClass("selected"),t=!i.length||i.is(":last-child")?a.eq(0):i.next();else if(38==n)a.removeClass("selected"),t=!i.length||i.is(":first-child")?a.last():i.prev();else if(13==n)return t=a.filter(".selected"),t.trigger("click"),!1;t.addClass("selected")}}),$("#verify_form").submit(function(e){e.preventDefault();var t=$("#pd_stu").val(),a=$("#pd_btu").val(),n=$("#pd_identity").val(),i=$("#latest_status").val(),s=$("#note").val();$.ajax({context:this,url:t+"weapons/send_verification",type:"post",dataType:"json",cache:!0,data:{latest_status:i,note:s,pd_identity:n},beforeSend:function(){$(this).parent().append('<img id="loader" src="'+a+'assets/images/loading.gif" alt="Loading"/>'),$("#complain .close_btn").prop("disabled",!0)},complete:function(){$("#loader").remove(),$("#complain .close_btn").prop("disabled",!1)}}).done(function(e){$("#loader").remove(),$("#compalin").modal("hide"),"yes"==e.sent?swal("Verification Sent","Thanks for your info","success"):swal("Problem","Something gone wrong","error")})}),$(".search_place,#vehicle_name,#search_place").on("keydown",function(e){var t,a=$(this).next().find("a"),n=e.keyCode,i=a.filter(".selected");if(40==n||38==n||13==n){if(40==n)a.removeClass("selected"),t=!i.length||i.is(":last-child")?a.eq(0):i.next();else if(38==n)a.removeClass("selected"),t=!i.length||i.is(":first-child")?a.last():i.prev();else if(13==n)return t=a.filter(".selected"),t.trigger("click"),!1;t.addClass("selected")}});var s=null;$("#vehicle_name").keyup(function(e){var t=e.keyCode;if(40==t||38==t||13==t)return!1;null!==s&&(s.abort(),s=null);var a=$.trim($(this).val());if(!a.length)return!1;var n=$("#pd_stu").val(),i=$("#pd_btu").val();s=$.ajax({context:this,url:n+"/weapons/get_transports",type:"get",dataType:"json",cache:!0,data:{typing:a},beforeSend:function(){$(this).parent().append('<img id="loader" src="'+i+'assets/images/loading.gif" alt="Loaind"/>')},complete:function(){$("#loader").remove()}}).done(function(e){$("#loader").remove();for(var t="",a=0;a<e.length;a++)t+='<a href="javascript:void(0);" class="list-group-item">'+e[a].poribohon+"</a>";$(this).next().show().html(t)})}),$("#vehicle_name").on("blur change",function(){var e=$(this).val(),t=$('input[name="f"]').val(),a=$('input[name="t"]').val();check_duplicacy(e,t,a)}),$("#vehicle .list-group").on("click",".list-group-item",function(){var e=$(this).text(),t=$('input[name="f"]').val(),a=$('input[name="t"]').val();check_duplicacy(e,t,a)}),$(".transport_name").on("blur change",function(){var e=$("#pd_stu").val(),t=$(this).val(),a=$("#pd_identity").val();$.ajax({context:this,url:e+"weapons/transport_duplicacy",type:"post",dataType:"json",cache:!0,data:{name:t,pd:a}}).done(function(e){"yes"==e.exist&&swal("Transpport Exist","This transport already exist","error")})}),$("#main_search .search_place").blur(function(){var e=$(this).val();e.length>0&&$(this).removeAttr("style")}),$(".evidence").change(function(){var e=this.files[0],t=e.name,a=t.split(".").pop().toLowerCase(),n=["jpg","png","gif","jpeg"];return""===e||-1===$.inArray(a,n)?(swal("Allowed Types","jpg, png, gif, jpeg","warning"),$(".file-input-name").remove(),!1):void 0}),$('select[name="fd"]').change(function(){var e=$.trim($(this).val()),t=$(this).data("thana");get_thanas(e,t)}),$('select[name="td"]').change(function(){var e=$.trim($(this).val()),t=$(this).data("thana");get_thanas(e,t)}),$("#suggestion_page .list-group").on("click",".list-group-item",function(){var e=$(this).text();$(this).parent().prev().val(e),$(this).parent().empty(),$('#main_search input[name="f"],#main_search input[name="t"]').removeAttr("style")}),$("#stoppage_section .list-group-item").live("click",function(){var e=$(this).text();$(this).parent().prev().val(e),$(this).parent().empty()}),$(document).click(function(){$("#suggestion_page .list-group").empty()}),$("#add_stoppage").click(function(){var e=$("#place_name").val(),t=$("#comment").val(),a=$("#rents").val();$("#stoppage_section").show(),$('<div class="form-group stoppage"><div class="col-xs-10 col-md-4"><input maxlength="150" type="text" class="form-control place_name" name="place_name[]" placeholder="'+e+'" autocomplete="off"><div class="list-group suggestion"></div></div><div class="col-xs-10 col-md-5"><textarea maxlength="1000" class="form-control" name="comments[]" placeholder="'+t+'"></textarea></div><div class="col-xs-10 col-md-2"><input maxlength="10" type="text" class="form-control rent" name="rent[]" placeholder="'+a+'"></div><button class="btn btn-xs btn-danger" href="javascript:void(0)" class="cancel"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></div>').appendTo($("#stoppage_section")).hide().slideDown()}),$("#stoppage_section").on("click","button",function(e){e.preventDefault();var t=$("#pd_stu").val(),a=$("#pd_identity").val(),n=$(this).parent().find(".place_name").val();confirm("Are you Sure?")&&($.ajax({context:this,url:t+"weapons/delete_stopage",type:"get",dataType:"json",cache:!0,data:{pri:a,jaig:n}}).done(function(e){if("done"==e.deleted&&$("#point").length>0){var t=parseInt($("#point").val()),a=t-1;$("#point").val(a)}}),$(this).parent().fadeOut("normal",function(){$(this).remove(),$(".order_pos").each(function(e){var t=e+1;$(this).val(t)})}))}),$("#transport").on("click",".remove_address",function(e){return e.preventDefault(),confirm("Are you Sure?")?($(this).parent().parent().remove(),!1):void 0}),$(".add_district").on("change",function(){var e=$.trim($(this).val()),t=$("#pd_stu").val();$.ajax({context:this,url:t+"weapons/get_thanas",type:"get",dataType:"json",cache:!0,data:{district:e},beforeSend:function(){$(this).parent().next().find(".thana").parent().append('<small id="text_loader">Loading thanas...</small>')},complete:function(){$("#text_loader").remove()}}).done(function(e){for(var t="",a=0;a<e.length;a++)t+='<option value="'+e[a].id+'">'+e[a].thana+"</option>";$(this).parent().next().find(".thana").html(t)})}),$("#add_address").on("click",function(){var e=$("div.address:first"),t=e.find("select.add_district option:selected").val(),a=e.clone(!0,!0);a.find("textarea").val(""),a.find("textarea").css("width","190px"),a.find("select.add_district").val(t),a.find("select.add_district").trigger("change"),$(a).insertAfter("div.address:last").hide().slideDown(),$('<button class="btn btn-xs btn-danger remove_address"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>').insertAfter("div.address:last .add_details")}),$("#departure_time").change(function(){var e=$("#custom_time").val();2==$(this).val()?$('<div id="departure_dynamic" class="form-group"><label class="col-sm-3 control-label"></label><div class="col-xs-10 col-md-6"><input maxlength="200" type="text" class="form-control"  name="departure_dynamic" placeholder="'+e+'"></div></div>').insertAfter("#departure_perticular").hide().slideDown():$("#departure_dynamic").slideUp(500,function(){$("#departure_dynamic").remove()}),"yes"==$(this).data("merge")&&($("#departure_dynamic label").removeClass("col-sm-3"),$("#departure_dynamic label + div").removeClass("col-xs-10 col-md-6"))}),$("#chkUsername").on("blur",function(){is_exist("chkUsername","username","users","userInfo")}),$("#chkEmail").on("blur",function(){var e=$("#chkEmail").val(),t=$("#email_text").val(),a=$(".wrong_email").is(":visible"),n=/^[a-zA-Z0-9]+[a-zA-Z0-9_.-]+[a-zA-Z0-9_-]+@[a-zA-Z0-9]+[a-zA-Z0-9.-]+[a-zA-Z0-9]+.[a-z]{2,4}$/;if(n.test(e))$(".wrong_email").fadeOut("normal",function(){$(this).remove()}),is_exist("chkEmail","email","users","emailInfo");else if(!a)return $('<div class="alert alert-warning wrong_email">'+t+"</div>").insertAfter("#emailInfo").hide().slideDown(),!1}),$("form").on("blur",".rent",function(){var e=replaceNumbers($(this).val());$(this).val(e);var t=parseInt(e);isNaN(t)||1>t?($(this).parent().find(".alert").remove(),$(this).parent().append('<div class="alert alert-danger">Numbers only</div>'),$(this).val("")):$(this).parent().find(".alert").remove()}),$("#social_link1").hover(function(){$(this).stop(!0,!0).animate({width:"+=105px"},100,"",function(){if($(this).children("span").length<1){var e=$("#find_fb").val();$(this).append("<span>"+e+"</span>")}})},function(){$(this).children("span").remove(),$(this).stop(!0,!0).animate({width:"-=105px"})}),$("#social_link2").hover(function(){$(this).stop(!0,!0).animate({width:"+=105px"},100,"",function(){if($(this).children("span").length<1){var e=$("#find_tw").val();$(this).append("<span>"+e+"</span>")}})},function(){$(this).children("span").remove(),$(this).stop(!0,!0).animate({width:"-=105px"})}),$("#social_link1,#social_link2").mouseleave(function(){$(this).children("span").remove()})});